"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function isDebugEnabled(){return"true"===localStorage.getItem("openweb-webcomponents:debug")}!function(n,r){var p,e,u,o;n.BbvaComponent||(o=!1,n.BBVAData=function(){this.data={}},n.BBVAData.prototype.append=function(t,e){this.data[t]=e},n.BBVAData.prototype.set=n.BBVAData.prototype.append,n.BBVAData.prototype.delete=function(t){delete this.data[t]},n.BBVAData.prototype.get=function(t){return this.data[t]},n.BBVAData.prototype.getFormData=function(){var t,e=new FormData;for(t in this.data)e.append(t,this.data[t]);return e},n.BbvaComponent=function(){(u=this).statSent=!1,u.armadilloPath="/auth/",-1!==n.location.host.indexOf("localhost")||-1!==n.location.host.indexOf("127.0.0.1")?(u.domain="http://localhost:9090",u.api="".concat(u.domain,"/bbva-components/"),u.armadillo="https://ec2-52-214-22-49.eu-west-1.compute.amazonaws.com".concat(u.armadilloPath),u.libs="/lib/",u.components="/src/components/"):(u.domain="",u.api="".concat(u.domain,"/bbva-components/"),u.armadillo=u.domain+u.armadilloPath,u.libs="https://d3l7jhiu2gy1zw.cloudfront.net/lib/",u.components="https://d3l7jhiu2gy1zw.cloudfront.net/components/"),u.queryParams=!1,u.isLogged=n.BbvaComponent.isLogged,u.getUserLogged=n.BbvaComponent.getUserLogged,u.debug=function(){var t;isDebugEnabled()&&(t=console).log.apply(t,["%c[OPENWEB]","background: #072146; color: #FFFFFF"].concat(Array.prototype.slice.call(arguments)))},u.error=function(){var t;(t=console).error.apply(t,["%c[OPENWEB] ðŸ”¥","background: #072146; color: #FFFFFF"].concat(Array.prototype.slice.call(arguments)))},u.init=function(t){n.jQuery===r&&(u.debug("Loading jQuery 1.9.1 ..."),u.loadJs("".concat(u.libs,"jQuery/1.9.1.js"),function(){})),p=n.jQuery,(e=p)(document).ready(function(){var a=u.getProject();a?(p("[data-component-bbva]").not("[comp-loaded]").each(function(t,e){(e=p(e)).data("comp-loaded",!0);var o=e.data("component-bbva");u.loadComponent(o,function(){var t=new BbvaComponent[o];t.rootElement=e,t.config={},t.config.thread=u.getThread(e),t.config.project=a,t.init()})}),u.sendStat()):u.error("Falta el parÃ¡metro project iniciar BBVA Components")})},u.loadComponent=function(a,t){u.loadJs("".concat(u.components+a,"/js/index.js"),function(){u.debug("Cargado el componente ".concat(a)),e.ajax({contentType:"application/json",url:"/bbva-components/ui/".concat(a),method:"POST"}).done(function(t,e,o){u.debug("component ".concat(a," load registered"),{data:t,status:e,xhr:o})}).fail(function(t){u.error("Error sending component usage",t)}),t&&"function"==typeof t&&t()})},u.loadJs=function(t,e){var o=document.createElement("script");if("string"==typeof t&&(t={uri:t}),o.setAttribute("type","text/javascript"),o.setAttribute("src",t.uri),t.params)for(var a in t.params)o.setAttribute(a,t.params[a]);e&&(o.readyState?o.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||e()}:o.onload=e),(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(o)},u.loadCss=function(t){p("<link>",{rel:"stylesheet",type:"text/css",href:t}).appendTo("head")},u.setCookie=function(t,e,o){var a=t.trim(),n=new Date;if(e="object"===_typeof(e)?JSON.stringify(e):"".concat(e).trim(),a="".concat(a,"=").concat(e,";"),o)for(var r in o){e=o[r];"expires"===r?(n.setTime(n.getTime()+24*e*60*60*1e3),a="".concat(a,"expires=").concat(n.toUTCString(),";")):a+="".concat(r,"=").concat(e,";")}else n.setTime(n.getTime()+2592e6),a="".concat(a,"expires=").concat(n.toUTCString());document.cookie=a},u.getCookie=function(t){for(var e=document.cookie.split(";"),o=0;o<e.length;o++)try{var a=e[o].split("=");if(a[0].trim()===t)return a[1]}catch(t){return u.error("Error cargando cookie"),u.error(t),!1}return!1},u.getThread=function(t){var e=!1;try{t&&(e=t.data("thread"))}catch(t){e=!1}return e||u.loadThread()},u.loadThread=function(){return encodeURI(n.location.pathname)},u.getReCaptchaHtml=function(t){var e='<div class="form-group">';return t.captchaText&&(e+="<label>".concat(t.captchaText,"</label>")),e=e+'<div class="g-recaptcha" id="ow_recaptcha" data-sitekey="'.concat(t.reCaptchaKey,'"></div>')+"</div>"},u.renderRecaptcha=function(e){u.addRecaptchaLib(function(t){!t||t instanceof Event||u.error("Error loading reCaptcha lib",t),"function"==typeof e&&e(t)})},u.addRecaptchaLib=function(t){o?"function"==typeof t&&t():(o=!0,u.loadJs({uri:"https://www.google.com/recaptcha/api.js",params:{async:"",defer:""}},t))},u.getFormData=function(t,e){var o=u.serializeForm(t.serializeArray());return e&&p.extend(o,e),u.serializeAttachments(t,o)},u.serializeForm=function(t){var e={};return p.each(t,function(){e[this.name]!==r?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},u.serializeAttachments=function(t,e){var a,n,o,r=new BBVAData,i=!1,t=t.find('input[type="file"]'),c=0;if(p(t).each(function(t,e){if(!(c<0)){var o=p(e);try{n=o[0].files,i=i||0<n.length;for(t=0;t<n.length;t++){if(a=n[t],52428800<(c+=a.size)){c=-1;break}r.append(o.attr("name"),a)}}catch(t){u.error(t)}}}),c<0)return!1;for(o in e){var s=e[o];"object"===_typeof(s)&&(s=JSON.stringify(s)),r.append(o,s)}return r},u.getQueryParam=function(t){if(!n.location.search)return r;if(!u.queryParams){u.queryParams={};for(var e=n.location.search.substr(1).split("&"),o=0;o<e.length;o++){var a=e[o].split("=");u.queryParams[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}}return u.removeTags(u.queryParams[t])},u.strip_tags=function(t,o){o=("".concat(o||"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");return t.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,"").replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,function(t,e){return-1<o.indexOf("<".concat(e.toLowerCase(),">"))?t:""})},u.removeTags=function(t){return null!==t&&""!==t&&(t=t.toString()).replace(/(<([^>]+)>?)/gi,"")},u.apiCall=function(t,e,o,a,n){u.setPreApi();var r="",r="object"===_typeof(t)&&t.url?"".concat(t.url,"?"):("/"===t.substr(0,1)&&(t=t.substr(1)),"".concat(u.api+t,"?"));if(e)for(var i in e)r+="&".concat(i,"=").concat(e[i]);t={method:o||"GET",type:o||"GET",url:r};if("GET"!==o&&a){o=!1;if(a instanceof File){var c=a;(a=new FormData).append("file",c),o=!0}else if("object"!==_typeof(a)||a instanceof BBVAData)a instanceof BBVAData&&(a=a.getFormData());else try{a=JSON.stringify(a)}catch(t){}t.data=a,o||"function"==typeof a.append?(t.cache=!1,t.contentType=!1,t.processData=!1):(t.dataType="json",t.contentType="application/json")}p.ajax(t).done(function(t,e,o){u.setUserInfo(o),n&&n(null,t)}).fail(function(t){n&&n(t)})},u.setUserInfo=function(t){try{n.BbvaDevice||(n.BbvaDevice=t.getResponseHeader("device")),n.BbvaCountry||(n.BbvaCountry=t.getResponseHeader("country"))}catch(t){u.error("Error recuperando paÃ­s y dispositivo",t)}},u.hide=function(){this.rootElement.hide()},u.getProject=function(){var t=p("[data-bbva-project]").data("bbva-project");return!!t&&t.trim()},u.show=function(t){this.rootElement.slideDown(t)},u.sendStat=function(){var t,e;u.statSent||(u.statSent=!0,t=navigator.platform,e=n.location.hostname,u.apiCall("stats/visits",{project:u.getProject(),url:e,platform:t},"GET",!1,function(t,e){t?u.error("sendStat: Error registering visit.",t):e&&u.autoComponents(e)}))},u.autoComponents=function(t){if(t)try{var e;if("string"==typeof t)try{e=JSON.parse(t).data}catch(t){return void u.error("autoComponents: Error parsing configuration",t)}else e=t.data;e&&e.analytics&&u.addAnalytics(e.analytics)}catch(t){u.error("autoComponents: Error starting",t)}},u.addAnalytics=function(t){p("head").append('\x3c!-- Global site tag (gtag.js) - Google Analytics --\x3e<script async src="https://www.googletagmanager.com/gtag/js?id='+t.key+"\"><\/script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', '"+t.key+"');<\/script>")},u.setPreApi=function(){var t=p("[data-bbva-api]").data("bbva-api");t&&-1!==n.location.host.indexOf("ec2")&&(u.domain="".concat(n.location.protocol,"//").concat(t.trim()),u.api="".concat(u.domain,"/bbva-components/"),u.armadillo=u.domain+u.armadilloPath)},u.compareObjects=function(t,e){var o,a={};for(o in t)!function t(e,o){try{if(!o)return!1;var a,n=!0;for(a in e)if("object"===_typeof(e[a])){var r,i=e[a],c=o[a];for(r in i)if(!1===(n=t(i[r],c[r])))return!1}else e!==o&&(n=!1);return n}catch(t){return!1}}(t[o],e[o])&&(a[o]=t[o]);return a}},n.BbvaComponent.loader=function(e,o){var t;BbvaComponent[e]?(t=new BbvaComponent[e],o(t)):(new BbvaComponent).loadComponent(e,function(){var t=new BbvaComponent[e];o(t)})},n.BbvaComponent.getUserLogged=function(o){return n.wpBbvaUserLogged?"function"==typeof o?o(null,n.wpBbvaUserLogged):n.wpBbvaUserLogged:"function"!=typeof o?null:void BbvaComponent.loader("authbbva",function(t){t.loadUser(function(t,e){if("function"==typeof o)return t?o(t):o(null,e)})})},n.BbvaComponent.isLogged=function(){return!1!==u.getCookie("CloudFront-Key-Pair-Id")},(new BbvaComponent).init())}(window);